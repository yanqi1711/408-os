# 进程与线程

## 进程与线程
### 进程的概念与特征
进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位
```mermaid
flowchart LR
  A[进程组成]
  B[PCB]
  C[进程描述信息]
  D[进程控制和管理信息]
  E[资源分配清单]
  F[处理机相关信息]
  G[程序段]
  H[程序的代码（指令序列）]
  I[数据段]
  J[运行过程中产生的各种数据（如程序中定义的各种变量）]
  A --> B
  A --> G
  A --> I
  B --> C
  B --> D
  B --> E
  B --> F
  G --> H
  I --> J
```
PCB给操作系统用的<br>
程序段、数据段给进程自己用的

特征: 动态性、并发性、独立性、异步性、结构性<br>
动态性是最基础的特性

### 进程的状态与转换

```mermaid
flowchart LR
  A[三种基本状态]
  B[运行态]
  C[占有CPU，并在CPU上运行]
  D[就绪态]
  E[已经具备运行条件，但是由于没有空闲CPU，而暂时不能运行]
  F[阻塞态]
  H[因等待某一事件而暂时不能运行]
  I[另外两种状态]
  J[创建态]
  K[进程正在被创建，操作系统为进程分配资源、初始化PCB]
  L[终止态]
  M[进程正在从系统中撤销，操作系统会回收进程拥有的资源、撤销PCB]

  A --> B
  A --> D
  A --> F
  B --> C
  D --> E
  F --> H
  I --> J
  I --> L
  J --> K
  J --> M
```
进程PCB中会有一个`变量state`来表示进程当前状态

进程的转换:
<img src="./img/进程三种状态的转换.png" max-width="80%"/>

进程的组织:
- 链接方式
  - 按照进程状态将PCB分为多个队列
  - 操作系统持有指向各个队列的指针
- 索引方式
  - 根据进程状态的不同，建立几张索引表
  - 操作系统持有指向各个索引表的指针

### 进程控制
进程的创建、终止、阻塞、唤醒的过程

创建
```mermaid
flowchart LR
  A[创建原语]
  X[申请空白PCB]
  B[为新进程分配所需资源]
  C[初始化PCB]
  D[将PCB插入就绪队列]
  E[引起进程创建的事件]
  F[用户登陆]
  G[分时系统中，用户登录成功，系统会建立为其建立一个新的进程]
  H[作业调度]
  I[多道批处理系统中，有新的作业放入内存时，会为其建立一个新的进程]
  J[提供服务]
  K[用户向操作系统提出某些请求时，会新建一个进程处理该请求]
  L[应用请求]
  M[由用户进程主动请求创建一个子进程]
  A --> X
  A --> B
  A --> C
  A --> D
  E --> F
  E --> H
  E --> J
  E --> L
  F --> G
  H --> I
  J --> K
  L --> M
```
